<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Autonomous World</title>
  </head>
  <body>
    <canvas id="glcanvas" tabindex="1"></canvas>
    <script src="https://not-fl3.github.io/miniquad-samples/mq_js_bundle.js"></script>
    <script type="module">
      import init, {
        set_wasm,
      } from "./wasm/autonomous-game.js";

      window.wasmInitialized = new Promise(async (resolve) => {
        let wbg = await init();
        
        miniquad_add_plugin({
          register_plugin: (a) => (a.wbg = wbg),
          on_init: () => {
            set_wasm(wasm_exports);
            // Resolve the promise when initialization is complete
            resolve();
          },
          version: "0.0.1",
          name: "wbg",
        });
        
        load("./wasm/autonomous-game_bg.wasm");
      });

    </script>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
